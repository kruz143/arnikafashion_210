var etThemeBuilder,options_old={},etPreImport={};!function(a){"use strict";etThemeBuilder={init:function(){this.etGlobal.et_init(),this.etPresets.et_set_presets(),this.etPresets.et_init(),this.etMultipleTemplates.et_init()},etGlobal:{et_init:function(){this.et_show_builder(),this.et_collapse_builder(),this.et_edit(),this.et_add_options_devices(),this.et_switch_default_header(),this.et_switch_default_single_product(),this.et_reset_header_builder_settings()},et_show_builder:function(){wp.customize.panel("header-builder")&&(wp.customize.panel("header-builder").expanded.bind(function(b){if(a(".et_customizer-builder-header").hasClass("loaded"))return void etThemeBuilder.etHeader.et_close();a(".et_customizer-builder-header").length?(etThemeBuilder.etHeader.et_show(),etThemeBuilder.etHeader.et_force_resize(),etThemeBuilder.etHeader.et_resizable()):etThemeBuilder.etGlobal.et_load_builder("header")}),a(document).on("click",".customize-panel-back",function(a){etThemeBuilder.etHeader.et_close()})),wp.customize.panel("single_product_builder")&&(wp.customize.panel("single_product_builder").expanded.bind(function(b){if(a(".et_customizer-builder-single_product").hasClass("loaded"))return void etThemeBuilder.etSections.et_close(a(".et_customizer-builder-single_product"));a(".et_customizer-builder-single_product").length?etThemeBuilder.etSections.et_show(a(".et_customizer-builder-single_product")):etThemeBuilder.etGlobal.et_load_builder("product-single")}),a(document).on("click",".customize-panel-back",function(b){etThemeBuilder.etSections.et_close(a(".et_customizer-builder-single_product"))}))},et_load_builder:function(b){a.ajax({url:ajaxurl,method:"POST",data:{action:"et_ajax_template",template:b},dataType:"html",success:function(c){a(".wp-full-overlay").append(c),"header"==b?(etThemeBuilder.etHeader.et_show(),etThemeBuilder.etHeader.et_init()):"product-single"==b?(etThemeBuilder.etSections.et_show(a(".et_customizer-builder-single_product")),etThemeBuilder.etSections.et_init(".et_customizer-builder-single_product",{sticky:!0})):"product-archive"==b&&(etThemeBuilder.etSections.et_show(a(".et_customizer-builder-archive_product")),etThemeBuilder.etSections.et_init(".et_customizer-builder-archive_product",{sticky:!0}))},error:function(a){etThemeBuilder.etGlobal.et_notice("load-builder","error")},complete:function(){}})},et_add_options_devices:function(){wp.customize.section.each(function(b){b.expanded.bind(function(){var c="#accordion-section-"+b.id;if(!a(c).is(".et_device-added")){a(c).addClass("et_device-added");var d=a("#customize-footer-actions .devices-wrapper").html(),c="#"+a(c).attr("aria-owns");a.each(a(c).find("li[id*=_et-mobile], li[id*=_et-tablet], li[id*=_et-desktop]"),function(){var b=a(this).attr("id");b=b.replace("_et-mobile",""),b=b.replace("_et-tablet",""),b=b.replace("_et-desktop",""),a("li[id*="+b+"_et]").length>1&&a(this).addClass("multi-device").prepend(d)})}"mobile_panel"==b.id&&a(".devices-wrapper .preview-mobile").trigger("click")})})},et_generate_random:function(a){var b="",c="23456789ABCDEFHJKLMNPRTVWXYZabcdefghijklmnopqrstuvwxyz";a||(a=5);for(var d=0;d<a;d++)b+=c.charAt(Math.floor(Math.random()*c.length));return b},et_collapse_builder:function(){a(document).on("click",".et_collapse-builder",function(b){b.preventDefault();var c=a(this).attr("data-panel");a(".et_customizer-builder-"+c).hasClass("collapsed")?a(".et_customizer-builder-"+c).removeClass("collapsed"):a(".et_customizer-builder-"+c).addClass("collapsed")})},et_edit:function(){a(document).on("click",".et_edit",function(b){if(b.preventDefault(),"connect_block_package"==a(this).attr("data-section"))return void etThemeBuilder.etConnectBlock.et_popup(a(this));var c=a(this).attr("data-section");if(c.toLowerCase().indexOf("sidebar-widgets")>=0)return void wp.customize.panel("widgets").focus();var d=wp.customize.control(c).section();if(wp.customize.section(d).focus(),a(this).is("[data-option]")){var e=a(this).attr("data-option");a("#customize-controls .wp-full-overlay-sidebar-content").animate({scrollTop:a(e).offset().top},1e3)}})},et_range_fields:function(a){var b=jQuery(a),c=jQuery(b).find('input[type="range"]'),d=jQuery(b).find('input[type="text"]');jQuery(b).data("default");c.on("mousemove change",function(){d.attr("value",c.val())}),d.on("input paste change",function(){c.attr("value",d.val())})},et_switch_default_header:function(){a(document).on("click","#etheme-disable-default-header",function(){var b=a(this).is(":checked");a(this).attr("checked",b),a(this).checked=b,setTimeout(function(b,c){if(!confirm("Are you sure ?"))return a(b).attr("checked",!c),void(a(b).checked=!c);a.ajax({url:ajaxurl,method:"POST",data:{action:"et_ajax_switch_default",type:"header_builder",value:c},success:function(a){location.reload()},error:function(a){etThemeBuilder.etGlobal.et_notice("switch-header","error")}})},350,a(this),b)})},et_switch_default_single_product:function(){a(document).on("click","#etheme-disable-default-single-product",function(){var b=a(this).is(":checked");a(this).attr("checked",b),a(this).checked=b,setTimeout(function(b,c){if(!confirm("Are you sure ?"))return a(b).attr("checked",!c),void(a(b).checked=!c);a.ajax({url:ajaxurl,method:"POST",data:{action:"et_ajax_switch_default",type:"single_product_builder",value:c},success:function(a){location.reload()},error:function(a){etThemeBuilder.etGlobal.et_notice("switch-single-product","error")}})},350,a(this),b)})},et_reset_header_builder_settings:function(){a(document).on("click","#etheme-reset-header-builder",function(){confirm("Are you sure ? This will remove all your prebuild elements.")&&a.ajax({url:ajaxurl,method:"POST",data:{action:"et_ajax_get_presets",preset:"clear"},dataType:"json",success:function(b){var c="",d=a(".et_customizer-builder").attr("class");c=encodeURI(b.connect_block_package),wp.customize.control("header_top_elements").setting.set(b.header_top_elements),wp.customize.control("header_main_elements").setting.set(b.header_main_elements),wp.customize.control("header_bottom_elements").setting.set(b.header_bottom_elements),wp.customize.control("connect_block_package").setting.set(c),c=encodeURI(b.connect_block_mobile_package),wp.customize.control("header_mobile_top_elements").setting.set(b.header_mobile_top_elements),wp.customize.control("header_mobile_main_elements").setting.set(b.header_mobile_main_elements),wp.customize.control("header_mobile_bottom_elements").setting.set(b.header_mobile_bottom_elements),wp.customize.control("connect_block_mobile_package").setting.set(c),a(".et_customizer-builder").html(b.template),a(".et_customizer-builder").attr("class",d),etThemeBuilder.etHeader.et_sortable(),etThemeBuilder.etHeader.et_resizable(),a(".et_customizer-builder").prepend('<div class="et-message et-warning" style="margin:0 -15px;">Please, save your changes and reload your page after you have chosen your template.</div>'),setTimeout(function(){a(".et_customizer-builder").find("> .et-message").fadeOut()},2e4)},error:function(a){etThemeBuilder.etGlobal.et_notice("reset-header-builder","error")},complete:function(){}})})},et_get_notice:function(b){var c=a("#etheme_ajax-notices").html();return c=JSON.parse(c),c[b]},et_notice:function(a,b,c){c||(c="");var d=etThemeBuilder.etGlobal.et_get_notice(a);switch(b){case"error":console.error(d+c);break;case"warning":console.warn(d+c);break;case"log":console.log(d+c);break;case"alert":alert(d+c);break;default:console.log(d+c)}},et_panel_resize:function(b){function c(b){a("#customize-preview").addClass("et_no-events");var c=h-(b.pageY-j);c>g&&(e.style.height=c+"px",e.style.top=i+(b.pageY-j)+"px")}function d(){a("#customize-preview").removeClass("et_no-events"),window.removeEventListener("mousemove",c)}var e=a(b).get(0),f=a(b+" .et_panel-resizer").get(0),g=250,h=0,i=0,j=0;f.addEventListener("mousedown",function(a){a.preventDefault(),h=parseFloat(getComputedStyle(e,null).getPropertyValue("height").replace("px","")),i=e.getBoundingClientRect().top,j=a.pageY,window.addEventListener("mousemove",c),window.addEventListener("mouseup",d)})}},etMultipleTemplates:{et_init:function(){this.et_show(),this.et_multiples_actions(),this.et_conditions_actions(),this.et_save_multiple_in_bar()},et_save_multiple_in_bar:function(){a(document).on("click",".et_save-multiple-in-bar",function(){a(".et_header-save:not(.hidden)").trigger("click")})},et_show:function(){var b=[".et_call-multiple-headers",".et_call-multiple-single-products"];a(document).on("click",b.join(","),function(b){b.preventDefault();var c,d,e,f=a(this),g="";f.hasClass("et_call-multiple-headers")?(c=".et_headers-multiple",d=".et_headers-multiple-headers .et_headers-multiple-content",e=a(".et_customizer-builder-header"),g="header"):f.hasClass("et_call-multiple-single-products")&&(c=".et_product-single-multiple",d=".et_product-single-multiple-products .et_product-single-multiple-content",e=a(".et_customizer-builder-single_product"),g="single-product"),c&&d&&e&&g||etThemeBuilder.etGlobal.et_notice("wrong-multiple-section","error"),a(".et_button.mobile, .et_button.desktop").addClass("inactive"),f.addClass("active"),a(c).length?a(c).removeClass("hidden"):etThemeBuilder.etMultipleTemplates.et_load_multiple(g,c,e,d),e.find(".et_button.show-builder").removeClass("hidden"),e.find(".et_button.show-builder").on("click",function(b){a(e).find(".et_button.show-builder").addClass("hidden"),a(c).addClass("hidden")})})},et_load_multiple:function(b,c,d,e){a.ajax({url:ajaxurl,method:"POST",data:{action:"et_ajax_template",template:"multiple-section",builder:b},dataType:"html",success:function(f){a(c).remove(),d.find(".et_header-head").after(f),a(c).removeClass("hidden"),a(e).find("ul li").length||etThemeBuilder.etMultipleTemplates.et_create_default_template(b,e),a(".et_header-action.et_header-outdoor-action.disabled").removeClass("disabled")},error:function(a){etThemeBuilder.etGlobal.et_notice("load-multiple","error")},complete:function(){a(c).removeClass("hidden")}})},et_create_default_template:function(b,c){var d=etThemeBuilder.etMultipleTemplates.et_get_options(!0,"save");a.ajax({url:ajaxurl,method:"POST",data:{action:"et_ajax_multiple",type:"add",header:"Default",options:d,builder:b},dataType:"json",success:function(b){a(c).html(b.headers)},error:function(a){etThemeBuilder.etGlobal.et_notice("default-multiple-template","error")},complete:function(){}})},et_get_options:function(b,c){var d={},e=a(".et_customizer-builder.loaded"),f=e.find(".et_options-data").html();f=JSON.parse(f),e.hasClass("et_customizer-builder-header")?b?(d.header_top_elements=btoa(wp.customize.control("header_top_elements").setting.get()),d.header_main_elements=btoa(wp.customize.control("header_main_elements").setting.get()),d.header_bottom_elements=btoa(wp.customize.control("header_bottom_elements").setting.get()),d.connect_block_package=btoa(decodeURI(wp.customize.control("connect_block_package").setting.get())),d.header_mobile_top_elements=btoa(wp.customize.control("header_mobile_top_elements").setting.get()),d.header_mobile_main_elements=btoa(wp.customize.control("header_mobile_main_elements").setting.get()),d.header_mobile_bottom_elements=btoa(wp.customize.control("header_mobile_bottom_elements").setting.get()),d.connect_block_mobile_package=btoa(decodeURI(wp.customize.control("connect_block_mobile_package").setting.get()))):(d.header_top_elements=wp.customize.control("header_top_elements").setting.get(),d.header_main_elements=wp.customize.control("header_main_elements").setting.get(),d.header_bottom_elements=wp.customize.control("header_bottom_elements").setting.get(),d.connect_block_package=decodeURI(wp.customize.control("connect_block_package").setting.get()),d.header_mobile_top_elements=wp.customize.control("header_mobile_top_elements").setting.get(),d.header_mobile_main_elements=wp.customize.control("header_mobile_main_elements").setting.get(),d.header_mobile_bottom_elements=wp.customize.control("header_mobile_bottom_elements").setting.get(),d.connect_block_mobile_package=decodeURI(wp.customize.control("connect_block_mobile_package").setting.get())):e.hasClass("et_customizer-builder-single_product")&&(d.product_single_elements=btoa(wp.customize.control("product_single_elements").setting.get()),d.connect_block_product_single_package=btoa(decodeURI(wp.customize.control("connect_block_product_single_package").setting.get())));var g=["html_block3","html_block2","html_block1"];return a.each(f,function(a,e){wp.customize.control(e)&&("save"==c&&g.indexOf(e)>-1&&b?d[e]=btoa(etThemeBuilder.etMultipleTemplates.utf8_encode(wp.customize.control(e).setting.get())):d[e]=wp.customize.control(e).setting.get())}),d},utf8_encode:function(a){if(null===a||void 0===a)return"";var b,c,d=a+"",e="",f=0;b=c=0,f=d.length;for(var g=0;g<f;g++){var h=d.charCodeAt(g),i=null;if(h<128)c++;else if(h>127&&h<2048)i=String.fromCharCode(h>>6|192,63&h|128);else if(55296!=(63488&h))i=String.fromCharCode(h>>12|224,h>>6&63|128,63&h|128);else{if(55296!=(64512&h))throw new RangeError("Unmatched trail surrogate at "+g);var j=d.charCodeAt(++g);if(56320!=(64512&j))throw new RangeError("Unmatched lead surrogate at "+(g-1));h=((1023&h)<<10)+(1023&j)+65536,i=String.fromCharCode(h>>18|240,h>>12&63|128,h>>6&63|128,63&h|128)}null!==i&&(c>b&&(e+=d.slice(b,c)),e+=i,b=c=g+1)}return c>b&&(e+=d.slice(b,f)),e},et_render_options:function(b){a.each(b,function(b,c){if(wp.customize.control(b)){"connect_block_package"!=b&&"connect_block_mobile_package"!=b&&"connect_block_product_single_package"!=b||wp.customize.control(b).setting.set(c);switch(wp.customize.settings.controls[b].type){case"kirki-box-model":a.each(c,function(a,c){wp.customize.control(b).container.find('[data-target-option="'+a+'"]').attr("value",c).trigger("change")});break;case"repeater":wp.customize.control(b).setting.set(c);break;case"kirki-sortable":a.each(wp.customize.control(b).container.find(".kirki-sortable-item"),function(d,e){c.indexOf(e)>-1||wp.customize.control(b).container.find('[data-value="'+a(this).data("value")+'"]').addClass("invisible").find("i.visibility").addClass("dashicons-visibility-faint").trigger("change")}),""!=c&&a.each(c,function(a,c){wp.customize.control(b).container.find('[data-value="'+c+'"]').removeClass("invisible").find("i.visibility").removeClass("dashicons-visibility-faint").trigger("change")}),wp.customize.control(b).setting.set(c);break;case"kirki-toggle":c=1===c||"1"===c||"true"===c||!0===c,wp.customize.control(b).setting.set(c);break;case"kirki-radio-image":wp.customize.control(b).setting.set(c),wp.customize.control(b).container.find('input[value="'+c+'"]').prop("checked",!0).trigger("change");break;case"kirki-typography":c["font-family"]&&(c["font-family"]=c["font-family"].replace("\\",""),c["font-family"]=c["font-family"].replace("\\","")),wp.customize.control(b).setting.set(c);var d=wp.customize.control(b).section();wp.customize.section(d).container.hasClass("et_binded")||wp.customize.section(d).expanded.bind(function(){var a=wp.customize.control(b).setting.get();wp.customize.control(b).container.find(".font-family select").val(a["font-family"]).trigger("change"),wp.customize.control(b).container.find(".variant select").val(a.variant).trigger("change"),wp.customize.control(b).container.find(".text-transform select").val(a["text-transform"]).trigger("change"),wp.customize.control(b).container.find(".font-size input").attr("value",a["font-size"]).trigger("change"),wp.customize.control(b).container.find(".letter-spacing input").attr("value",a["letter-spacing"]).trigger("change"),wp.customize.control(b).container.find(".line-height input").attr("value",a["line-height"]).trigger("change"),wp.customize.section(d).container.addClass("et_binded")}),wp.customize.control(b).container.find(".font-family select").val(c["font-family"]).trigger("change"),wp.customize.control(b).container.find(".variant select").val(c.variant).trigger("change"),wp.customize.control(b).container.find(".text-transform select").val(c["text-transform"]).trigger("change"),wp.customize.control(b).container.find(".font-size input").attr("value",c["font-size"]).trigger("change"),wp.customize.control(b).container.find(".letter-spacing input").attr("value",c["letter-spacing"]).trigger("change"),wp.customize.control(b).container.find(".line-height input").attr("value",c["line-height"]).trigger("change");break;case"kirki-background":wp.customize.control(b).setting.set(c);var e=wp.customize.control(b).container.find(".kirki-color-control");if(e.wpColorPicker("color",c["background-color"]),wp.customize.control(b).container.find(".background-repeat select").val(c["background-repeat"]).trigger("change"),wp.customize.control(b).container.find(".background-position select").val(c["background-position"]).trigger("change"),wp.customize.control(b).container.find('.background-size input[value="'+c["background-size"]+'"]').prop("checked",!0).trigger("change"),wp.customize.control(b).container.find('.background-attachment input[value="'+c["background-attachment"]+'"]').prop("checked",!0).trigger("change"),c["background-image"]){if(wp.customize.control(b).container.find(".thumbnail-image").length)wp.customize.control(b).container.find(".thumbnail-image img").attr("src",c["background-image"]);else{var f='<div class="thumbnail thumbnail-image"><img src="'+c["background-image"]+'" alt=""></div>';wp.customize.control(b).container.find(".attachment-media-view").prepend(f),wp.customize.control(b).container.find(".placeholder").remove()}wp.customize.control(b).container.find(".background-image-upload-remove-button").removeClass("hidden").css("display","inline-block"),wp.customize.control(b).container.find(".background-repeat").css("display","block"),wp.customize.control(b).container.find(".background-position").css("display","block"),wp.customize.control(b).container.find(".background-size").css("display","block"),wp.customize.control(b).container.find(".background-attachment").css("display","block")}else wp.customize.control(b).container.find(".thumbnail-image, .placeholder").remove(),wp.customize.control(b).container.find(".attachment-media-view").prepend('<div class="placeholder">No file selected</div>'),wp.customize.control(b).container.find(".background-image-upload-remove-button").addClass("hidden").css("display","none"),wp.customize.control(b).container.find(".background-repeat").css("display","none"),wp.customize.control(b).container.find(".background-position").css("display","none"),wp.customize.control(b).container.find(".background-size").css("display","none"),wp.customize.control(b).container.find(".background-attachment").css("display","none");break;case"kirki-wcag-tc":wp.customize.control(b).container.find(".tabs button").removeClass("active"),wp.customize.control(b).container.find('.tabs button[data-mode="custom"]').addClass("active"),wp.customize.control(b).container.find(".kirki-a11y-text-colorpicker-wrapper").hide(),wp.customize.control(b).container.find('.kirki-a11y-text-colorpicker-wrapper[data-id="custom"]').show();var e=wp.customize.control(b).container.find(".kirki-color-control");e.wpColorPicker("color",c),wp.customize.control(b).setting.set(c);break;case"kirki-color":wp.customize.control(b).setting.set(c);var e=wp.customize.control(b).container.find(".kirki-color-control");e.wpColorPicker("color",c);break;case"kirki-generic":wp.customize.control(b).setting.set(c);wp.customize.control(b).container.find("input").attr("value",c);break;default:["menu_item_dots_separator_et-desktop","menu_2_item_dots_separator_et-desktop","contacts_separator_type_et-desktop"].indexOf(b)>-1&&(c=c.replace(/\\/g,""),c="\\"+c),wp.customize.control(b).setting.set(c)}}}),setTimeout(function(){a(".wp-customizer").removeClass("et-preload")},300)},et_publish_btn:function(b,c){var d="";"single-product"==c?d=a(".customize-pane-parent .accordion-section:not(#accordion-panel-woocommerce) h3"):"header"==c&&(d=a(".customize-pane-parent .accordion-section:not(#accordion-panel-header-builder) h3"));var e=a("#customize-save-button-wrapper input"),f=a("#publish-settings"),g=etThemeBuilder.etGlobal.et_get_notice("save-text"),h='<input type="submit" name="et_save-multiple-in-bar" class="button button-primary save has-next-sibling et_save-multiple-in-bar" value="'+g+'">';"disable"==b?(a("#customize-save-button-wrapper").addClass("et_save-multiple loading "+c),f.addClass("hidden"),e.addClass("hidden"),e.addClass("disabled"),e.css({"pointer-events":"none"}),e.after(h),d.css({color:"rgba(34, 34, 34, 0.22)","pointer-events":"none","background-color":"transparent"}),d.parent().css({cursor:"not-allowed"})):(a("#customize-save-button-wrapper").removeClass("et_save-multiple loading "+c),a(".et_save-multiple-in-bar").remove(),f.removeClass("hidden"),e.removeClass("hidden"),e.removeClass("disabled"),e.css({"pointer-events":"all"}),d.css({color:"#222","pointer-events":"all","background-color":"transparent"}),d.parent().css({cursor:"pointer"}))},et_multiples_actions:function(){a(document).on("click",".et_call-new-header",function(b){a(".et_new-multiple-holder").hasClass("hidden")?a(".et_new-multiple-holder").removeClass("hidden"):a(".et_new-multiple-holder").addClass("hidden")}),a(document).on("click",".et_header-action",function(b){if(b.preventDefault(),!a(this).hasClass("disabled")){var c=a(this),d=c.attr("data-action"),e="",f={},g=c.parents("li"),h=a(".et_customizer-builder.loaded"),i="header",j=".et_headers-multiple-content",k=".et_headers-multiple-conditions .et_conditions";if(h.hasClass("et_customizer-builder-header")?(j=".et_headers-multiple-headers .et_headers-multiple-content",k=".et_headers-multiple-conditions .et_conditions",i="header"):h.hasClass("et_customizer-builder-single_product")&&(j=".et_product-single-multiple-products .et_product-single-multiple-content",k=".et_product-single-multiple .et_conditions",i="single-product"),"add"==d?(e=h.find(".et_add-new-multiple").val(),options_old=etThemeBuilder.etMultipleTemplates.et_get_options(!0)):e=c.hasClass("et_header-outdoor-action")?c.attr("data-header"):g.attr("data-header"),!e)return void etThemeBuilder.etGlobal.et_notice("name-your-template","alert");if("save"==d||"add"==d)f=etThemeBuilder.etMultipleTemplates.et_get_options(!0,"save"),a(".et_condition-action.et_condition-add").addClass("hidden"),a(".et_conditions-notice.header-notice").removeClass("hidden"),h.removeClass("et_editing-global"),a(".multiple-header-name").attr("data-name",null),"save"==d&&c.addClass("saving"),a(".wp-customizer").addClass("et-preload");else{if("edit"==d)return h.addClass("et_editing-global"),a(".multiple-header-name").attr("data-name",g.find(".et_header-title b").text()),g.addClass("editing"),etThemeBuilder.etMultipleTemplates.et_publish_btn("disable",i),options_old=etThemeBuilder.etMultipleTemplates.et_get_options(!0,"save"),g.find(".et_header-save").removeClass("hidden"),g.find(".et_header-edit").addClass("hidden"),a(".wp-customizer").addClass("et-preload"),void a.ajax({url:ajaxurl,method:"POST",data:{action:"et_ajax_multiple",type:"old",header:e,options:options_old,builder:i},dataType:"json",success:function(a){etThemeBuilder.etMultipleTemplates.et_multiples_ajax_action(d,e,f,h,i,j,k)},error:function(a){etThemeBuilder.etGlobal.et_notice("save-active-template-options","error")},complete:function(){}});if("remove"==d){if(!confirm("Are you sure? You will not be able to revert it back"))return;a(".et_conditions").html(""),a(".et_condition-action.et_condition-add").addClass("hidden"),a(".et_conditions-notice.header-notice").removeClass("hidden"),h.removeClass("et_editing-global"),a(".multiple-header-name").attr("data-name",null)}else"copy"==d&&h.addClass("et_editing-global")}"save-name"==d&&g.addClass("et_li-processing"),"edit-name"==d?(g.find(".et_title-editor").removeClass("hidden"),g.find(".et_header-title b").addClass("hidden"),g.find(".et_header-edit-name").addClass("hidden"),g.find(".et_header-save-name").removeClass("hidden")):etThemeBuilder.etMultipleTemplates.et_multiples_ajax_action(d,e,f,h,i,j,k)}})},et_multiples_ajax_action:function(b,c,d,e,f,g,h){var i="";"save-name"==b&&(i=a('[data-header="'+c+'"] .et_title-editor').val()),a.ajax({url:ajaxurl,method:"POST",data:{action:"et_ajax_multiple",type:b,header:c,options:d,builder:f,title:i},dataType:"json",success:function(d){if("save"==b?("header"==f?(e.find(".et_mobile-mod").html(a(d.builder).find(".et_mobile-mod").html()),e.find(".et_desktop-mod").html(a(d.builder).find(".et_desktop-mod").html()),etThemeBuilder.etHeader.et_sortable(),etThemeBuilder.etHeader.et_resizable()):"single-product"==f&&(e.find(".et_product-single-wrapper").html(a(d.builder).find(".et_product-single-wrapper").html()),etThemeBuilder.etSections.et_sortable(".et_customizer-builder-single_product")),etThemeBuilder.etMultipleTemplates.et_render_options(d.options),etThemeBuilder.etMultipleTemplates.et_conditions_save_all(c),etThemeBuilder.etMultipleTemplates.et_publish_btn("enable",f),a(h).html("")):a(g).html(d.headers),"edit"==b){a(h).html(d.conditions),a('[data-header="'+c+'"]').addClass("editing"),e.addClass("et_editing-global"),a('[data-header="'+c+'"] .et_header-save').removeClass("hidden"),a('[data-header="'+c+'"] .et_header-edit').addClass("hidden"),etThemeBuilder.etMultipleTemplates.et_render_options(d.options),a("#customize-save-button-wrapper").removeClass("loading");var i=e.attr("class");"header"==f?(e.find(".et_mobile-mod").html(a(d.builder).find(".et_mobile-mod").html()),e.find(".et_desktop-mod").html(a(d.builder).find(".et_desktop-mod").html()),e.attr("class",i),etThemeBuilder.etHeader.et_sortable(),etThemeBuilder.etHeader.et_resizable()):"single-product"==f&&(e.find(".et_product-single-wrapper").html(a(d.builder).find(".et_product-single-wrapper").html()),etThemeBuilder.etSections.et_sortable(".et_customizer-builder-single_product"),a(".et_call-multiple-single-products").trigger("click")),a(".et_condition-action.et_condition-add").removeClass("hidden")}"add"==b&&e.find(".et_builder-multiple-content ul li.last").find(".et_header-edit").trigger("click"),"edit"==b&&a(".et_conditions-notice.header-notice").addClass("hidden"),"copy"==b&&a('[data-header="'+d.id+'"] [data-action="edit"]').trigger("click")},error:function(a){etThemeBuilder.etGlobal.et_notice("multiple-action-error","error",b)},complete:function(){a(".et_li-processing").removeClass("et_li-processing"),etThemeBuilder.etHeader.et_resizable(),etThemeBuilder.etMultipleTemplates.et_conditions()}})},et_conditions_save_all:function(b){var c=[],d=[],e=0,f="header";a(".et_customizer-builder.loaded").hasClass("et_customizer-builder-header")?f="header":a(".et_customizer-builder.loaded").hasClass("et_customizer-builder-single_product")&&(f="single-product"),a.each(a(".et_condition"),function(){if(a(this).hasClass("et_to-remove"))d[e++]=a(this).attr("data-condition");else{var g=["site","select","all_singular","front_page","attachment","not_found","all_archives","author","date","search"],h=a(this).find(".secondary-select:not(.hidden)").val();h&&!g.includes(h)?h=JSON.parse(h):h||(h="");var i=a(this).find(".primary-select").val();"single-product"==f&&(i=JSON.parse(i));var j={header:b,primary:i,secondary:h,third:a(this).find(".third-select").val(),condition:a(this).attr("data-condition"),"sub-items":a(this).find(".sub-items").prop("checked")||!1,language:a(this).find(".et-languages-select").val()||!1};c[e++]=j}}),a.ajax({url:ajaxurl,method:"POST",data:{action:"et_ajax_conditions_actions",type:"save_all",data_save:c,data_remove:d,builder:f},dataType:"json",success:function(b){a(".et_customizer-builder.loaded .et_builder-multiples .et_builder-multiple-content").html(b.headers)},error:function(a){etThemeBuilder.etGlobal.et_notice("conditions-save","error")},complete:function(a){}})},et_conditions:function(){function b(a,b,c){if(b){var d=["product_cat","product_tag","brand","category","post_tag","portfolio_category"];c=JSON.parse(c),d.includes(c.slug)?a.find(".sub-items-section").removeClass("hidden").addClass("active"):a.find(".sub-items-section").removeClass("active").addClass("hidden")}else a.find(".sub-items-section").removeClass("active").addClass("hidden")}var c="header";a(".et_customizer-builder.loaded").hasClass("et_customizer-builder-header")?c="header":a(".et_customizer-builder.loaded").hasClass("et_customizer-builder-single_product")&&(c="single-product");var d=["site","select","all_singular","front_page","attachment","not_found","all_archives","author","date","search"];a(document).on("change",".primary-select",function(){var e=a(this).val(),f=a(this).parents(".et_condition");if("header"==c){b(f,!1,!1),f.find(".secondary-select").addClass("hidden");var g=f.find(".secondary-select.secondary-"+a(this).val());g.removeClass("hidden"),d.includes(g.val())||d.includes(e)||g.val().includes("post_type_archive")?(f.find(".select2-selection.select2-selection--single").addClass("hidden"),f.find(".third-select").removeClass("active")):(f.find(".select2-selection.select2-selection--single.hidden").removeClass("hidden"),f.find(".third-select").addClass("active"))}else"single-product"==c&&(f.find(".select2-selection.select2-selection--single.hidden").removeClass("hidden"),f.find(".third-select").addClass("active"),f.find(".third-select").val("").trigger("change"),b(f,!0,a(this).val()))}),a.each(a(".third-select:not(.active)"),function(){var b="";a(this).hasClass("hidden")&&(b="hidden");var d=a(this).select2({containerCssClass:b,ajax:{url:ajaxurl,dataType:"json",data:function(b){var d="";return"header"==c?d=a(this).parents("li").find(".secondary-select:not(.hidden)").val():"single-product"==c&&(d=a(this).parents("li").find(".primary-select").val()),{search:b.term,action:"et_ajax_conditions_data",data:JSON.parse(d)}},processResults:function(a){return{results:a}}}});d.data("select2")&&d.data("select2").on("open",function(a){this.results.clear(),this.dropdown._positionDropdown()})}),a(document).on("change",".secondary-select",function(){var c=a(this).parents(".et_condition");d.includes(a(this).val())||a(this).val().includes("post_type_archive")?(c.find(".select2-selection.select2-selection--single").addClass("hidden"),c.find(".third-select").removeClass("active"),b(c,!1,!1)):(c.find(".select2-selection.select2-selection--single.hidden").removeClass("hidden"),c.find(".third-select").addClass("active"),b(c,!0,a(this).val())),c.find(".third-select").val("").trigger("change")})},et_conditions_actions:function(){var b=["site","select","all_singular","front_page","attachment","not_found","all_archives","author","date","search"];a(document).on("click",".et_condition-action",function(){var c="header";a(".et_customizer-builder.loaded").hasClass("et_customizer-builder-header")?c="header":a(".et_customizer-builder.loaded").hasClass("et_customizer-builder-single_product")&&(c="single-product");var d=a(this).attr("data-action"),e={},f=a(this).parents(".et_condition"),g=f.find(".secondary-select:not(.hidden)").val();if(g&&!b.includes(g)?g=JSON.parse(g):g||(g=""),"save"==d)e={header:a(".et_headers-multiple-content .editing").attr("data-header"),primary:f.find(".primary-select").val(),secondary:g,third:f.find(".third-select").val(),condition:f.attr("data-condition")};else if("remove"==d)return void f.addClass("et_to-remove hidden");a.ajax({url:ajaxurl,method:"POST",data:{action:"et_ajax_conditions_actions",type:d,data:e,builder:c},dataType:"json",success:function(b){"add"==d?(a(".et_conditions").append(b.template),etThemeBuilder.etMultipleTemplates.et_conditions()):"remove"==d&&a(".et_headers-multiple-conditions .et_conditions").html(b.template)},error:function(a){etThemeBuilder.etGlobal.et_notice("conditions-select-data","error")},complete:function(){}})})}},etPresets:{et_init:function(){wp.customize.panel("header-builder")&&(a(document).on("change","#input_header_presets_package_et-desktop",function(){var b=wp.customize.control("header_presets_package_et-desktop").setting.get();a.ajax({url:ajaxurl,method:"POST",data:{action:"et_ajax_get_presets",preset:b},dataType:"json",success:function(b){var c="",d=a(".et_customizer-builder").attr("class")
;c=encodeURI(b.connect_block_package),wp.customize.control("header_top_elements").setting.set(b.header_top_elements),wp.customize.control("header_main_elements").setting.set(b.header_main_elements),wp.customize.control("header_bottom_elements").setting.set(b.header_bottom_elements),wp.customize.control("connect_block_package").setting.set(c);var e=a(b.template).find(".et_desktop-mod");e=a(e).removeClass("hidden"),a(".et_customizer-builder").find(".et_desktop-mod").replaceWith(e),a(".et_customizer-builder").attr("class",d),a.each(b.options,function(a,b){wp.customize.control(a)&&wp.customize.control(a).setting.set(b)}),etThemeBuilder.etHeader.et_sortable(),etThemeBuilder.etHeader.et_resizable(),a(".et_customizer-builder").find("> .et-message").remove(),a(".et_customizer-builder").prepend('<div class="et-message et-warning" style="margin:0 -15px;">Please, save your changes and reload your page after you have chosen your template.</div>')},error:function(a){etThemeBuilder.etGlobal.et_notice("get-preset","error")},complete:function(){setTimeout(function(){a(".et_customizer-builder").find("> .et-message").fadeOut()},2e4)}})}),a(document).on("change","#input_header_presets_package_et-mobile",function(){var b=wp.customize.control("header_presets_package_et-mobile").setting.get();a.ajax({url:ajaxurl,method:"POST",data:{action:"et_ajax_get_presets",preset:b},dataType:"json",success:function(b){var c="",d=a(".et_customizer-builder").attr("class");c=encodeURI(b.connect_block_mobile_package),wp.customize.control("header_mobile_top_elements").setting.set(b.header_mobile_top_elements),wp.customize.control("header_mobile_main_elements").setting.set(b.header_mobile_main_elements),wp.customize.control("header_mobile_bottom_elements").setting.set(b.header_mobile_bottom_elements),wp.customize.control("connect_block_mobile_package").setting.set(c);var e=a(b.template).find(".et_mobile-mod");e=a(e).removeClass("hidden"),a(".et_customizer-builder").find(".et_mobile-mod").replaceWith(e),a(".et_customizer-builder").attr("class",d),a.each(b.options,function(a,b){wp.customize.control(a)&&wp.customize.control(a).setting.set(b)}),etThemeBuilder.etHeader.et_sortable(),etThemeBuilder.etHeader.et_resizable(),a(".et_customizer-builder").find("> .et-message").remove(),a(".et_customizer-builder").prepend('<div class="et-message et-warning" style="margin:0 -15px;">Please, save your changes and reload your page after you have chosen your template.</div>')},error:function(a){etThemeBuilder.etGlobal.et_notice("get-preset","error")},complete:function(){setTimeout(function(){a(".et_customizer-builder").find("> .et-message").fadeOut()},2e4)}})}),a(document).on("change",'[data-id="header_presets_select"]',function(){var b=a(this).parents("li");b.css("pointer-events","none");var c=wp.customize.control("header_presets_select").setting.get();if(!c)return void b.css("pointer-events","all");a.ajax({url:ajaxurl,method:"POST",data:{action:"et_ajax_get_remote_preset",preset:c},dataType:"json",success:function(a){var c=JSON.parse(a);etThemeBuilder.etMultipleTemplates.et_render_options(c),etThemeBuilder.etPresets.et_refresh_builder(c),b.css("pointer-events","all")},error:function(a){},complete:function(){}})}),this.import_export())},et_refresh_builder:function(b){b.header_top_elements=btoa(b.header_top_elements),b.header_main_elements=btoa(b.header_main_elements),b.header_bottom_elements=btoa(b.header_bottom_elements),b.connect_block_package=btoa(b.connect_block_package),b.header_mobile_top_elements=btoa(b.header_mobile_top_elements),b.header_mobile_main_elements=btoa(b.header_mobile_main_elements),b.header_mobile_bottom_elements=btoa(b.header_mobile_bottom_elements),b.connect_block_mobile_package=btoa(b.connect_block_mobile_package),a.ajax({url:ajaxurl,method:"POST",data:{action:"et_ajax_builder",options:b},dataType:"json",success:function(b){var c=a(".et_customizer-builder-header").attr("class");a(".et_customizer-builder-header").find(".et_mobile-mod").html(a(b.builder).find(".et_mobile-mod").html()),a(".et_customizer-builder-header").find(".et_desktop-mod").html(a(b.builder).find(".et_desktop-mod").html()),a(".et_customizer-builder-header").attr("class",c),etThemeBuilder.etHeader.et_sortable(),etThemeBuilder.etHeader.et_resizable()},error:function(a){etThemeBuilder.etGlobal.et_notice("reset-header-builder","error")},complete:function(){a(".wp-customizer").removeClass("et-preload")}})},et_set_presets:function(){a(document).on("click",".preset-load",function(){var b=a(this).attr("data-preset");a.ajax({url:ajaxurl,method:"POST",data:{action:"et_ajax_get_presets",preset:b},dataType:"json",success:function(b){var c="",d=a(".et_customizer-builder").attr("class");c=encodeURI(b.connect_block_package),wp.customize.control("header_top_elements").setting.set(b.header_top_elements),wp.customize.control("header_main_elements").setting.set(b.header_main_elements),wp.customize.control("header_bottom_elements").setting.set(b.header_bottom_elements),wp.customize.control("connect_block_package").setting.set(c),a(".et_customizer-builder").html(b.template),a(".et_customizer-builder").attr("class",d),a.each(b.options,function(a,b){wp.customize.control(a)&&wp.customize.control(a).setting.set(b)}),etThemeBuilder.etHeader.et_sortable(),etThemeBuilder.etHeader.et_resizable()},error:function(a){etThemeBuilder.etGlobal.et_notice("set-preset","error")},complete:function(){}})})},import_export:function(){function b(b){if(etPreImport={},a(".et_header-import .et_header-import-btn").addClass("hidden"),a('.et_header-import .et_import-error[data-type="filedata"]').addClass("hidden"),a('.et_header-import .et_import-error[data-type="filetype"]').addClass("hidden"),"application/json"!=b.target.files[0].type)return a("#et_import-file").attr("value",""),void a('.et_header-import .et_import-error[data-type="filetype"]').removeClass("hidden");var d=new FileReader;d.onload=c,d.readAsText(b.target.files[0])}function c(b){var c=JSON.parse(b.target.result);if(!c.header_top_elements)return a("#et_import-file").attr("value",""),void a('.et_header-import .et_import-error[data-type="filedata"]').removeClass("hidden");a(".et_header-import .et_header-import-btn").removeClass("hidden"),etPreImport=c}a(document).on("click",".et_header-import-export .et_header-export-btn",function(){var a=etThemeBuilder.etMultipleTemplates.et_get_options(!1),b="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(a)),c=document.getElementById("et_download-export-file");c.setAttribute("href",b),c.setAttribute("download","header.json"),c.click()}),a(document).on("click",".et_header-import-btn span",function(){a(".wp-customizer").addClass("et-preload"),etThemeBuilder.etMultipleTemplates.et_render_options(etPreImport),etThemeBuilder.etPresets.et_refresh_builder(etPreImport),a(".et_header-import .et_header-import-btn").addClass("hidden"),a("#et_import-file").attr("value","").trigger("change")}),document.getElementById("et_import-file").addEventListener("change",b)}},etSections:{et_init:function(b,c){"object"!=typeof c&&(c={});var d={sticky:!1};c=Object.assign({},d,c),this.et_sortable(b),this.et_add_column(b,c),this.et_remove_column(b),this.et_remove_inside(b),this.et_set_options(b),this.et_style_column_popup(b),c.sticky&&this.et_column_popup(b),a.each(a(".et_product-block:not(.et_new-column)"),function(){etThemeBuilder.etGlobal.et_range_fields('[data-id="'+a(this).attr("data-id")+'"] .block-width')}),etThemeBuilder.etGlobal.et_panel_resize(".et_customizer-builder-single_product")},et_show:function(a){a&&(a.removeClass("hidden fadeOut").addClass("slide-top"),setTimeout(function(){a.addClass("loaded")},300))},et_close:function(a){a&&(a.removeClass("slide-top").addClass("fadeOut"),setTimeout(function(){a.removeClass("loaded collapsed").addClass("hidden")},300))},et_sortable:function(b){a(b).find(".et_product-single").sortable({cursorAt:{left:5,top:5},items:".et_product-block:not(.et_new-column)",helper:function(a,b){return'<span class="et_sorting-gost dashicons dashicons-image-rotate-left"></span>'},start:function(a,b){},stop:function(b,c){a.each(a(".et_product-block:not(.et_new-column)"),function(){etThemeBuilder.etSections.et_set_column(a(this))})}}).disableSelection(),a(b+" .et_column-inner, "+b+" .et_column-content").sortable({connectWith:".et_column-content, .et_inside-elements",cursorAt:{left:5,top:5},helper:function(a,b){return this.connectBlock=!1,this.removeData=!1,b.parents(".et_column").hasClass("et_products-elements")&&"connect_block"==b.attr("data-element")?(this.connectBlock="element-"+etThemeBuilder.etGlobal.et_generate_random(5),b.clone().insertAfter(b),b.attr("data-id",this.connectBlock),'<span class="et_sorting-gost dashicons dashicons-image-rotate-left"></span>'):'<span class="et_sorting-gost dashicons dashicons-image-rotate-left"></span>'},over:function(b,c){a(this).addClass("et_sorting-over")},out:function(b,c){a(this).removeClass("et_sorting-over")},start:function(b,c){var d=c.item;if(d.parents(".et_column").hasClass("et_product-block")){var e=etThemeBuilder.etSections.et_get_data();delete e[a(this).parents(".et_product-block").attr("data-id")].data[d.attr("data-id")],this.removeData=e}},stop:function(b,c){var d=c.item,e=d.parents(".et_product-block");if("connect_block"==d.attr("data-element")&&d.parent().hasClass("et_column-inner"))return void d.remove();if(d.parent().hasClass("et_inside-elements")){if("connect_block"==d.attr("data-element"))return void a(this).sortable("cancel");etThemeBuilder.etSections.et_set_data(this.removeData),a.each(d.parents(".et_popup").find(".et_customizer-element"),function(){etThemeBuilder.etConnectBlock.et_add_inside(a(this))})}else etThemeBuilder.etSections.et_set_data(this.removeData),a.each(e.find(".et_customizer-element"),function(){etThemeBuilder.etSections.et_add_inside(e,a(this))});this.connectBlock&&(etThemeBuilder.etSections.et_set_data(this.removeData),etThemeBuilder.etConnectBlock.et_add_block(this.connectBlock))}}).disableSelection()},et_column_popup:function(b){a(document).on("click",b+" .et_column-edit",function(){a(".et_popup").remove();var b=a(this),c=b.parents(".et_product-block"),d="",e=etThemeBuilder.etSections.et_get_data(),f=e[c.attr("data-id")].sticky;d+='<div class="et_popup ui-draggable ui-draggable-handle et_sticky-popup" data-id="">',d+='<div class="et_actions-1">',d+='<span class="dashicons dashicons-move"></span>',d+="<span>"+c.attr("data-title")+"</span>",d+='<span class="dashicons dashicons-no-alt et_close"></span>',d+="</div>",d+='<div class="et_inside-wrapper">',d+="<label>Select a block from the list for which the content will be fixed. Select <span>'none'</span> to disable fixed content.</label>",d+=" <select>",d+='<option value="false">None</option>',a.each(a(".et_customizer-builder.loaded .et_product-block:not(.et_new-column)"),function(){c.attr("data-id")!=a(this).attr("data-id")&&(f==a(this).attr("data-id")?d+='<option value="'+a(this).attr("data-id")+'" selected>'+a(this).attr("data-title")+"</option>":d+='<option value="'+a(this).attr("data-id")+'">'+a(this).attr("data-title")+"</option>")}),d+=" </select>",d+="</div>",d+="</div>",b.parents(".et_customizer-builder").find(".et_header-head").append(d),a(".et_popup").draggable(),a(document).on("click",".et_close, .customize-panel-back",function(){a(".et_popup").remove()}),a(".et_popup select").on("change",function(){c.attr("data-sticky",a(this).val()),etThemeBuilder.etSections.et_set_column(c)})})},et_style_column_popup:function(b){a(document).on("click",b+" .et_style-column",function(b){a(".et_popup").remove();var c=a(this),d=c.parents(".et_product-block"),e="";a(".customize-save-button-wrapper").hasClass("et_save-multiple")&&(e=a(".et_builder-multiple-content.et_product-single-multiple-content .editing").attr("data-header")),a.ajax({url:ajaxurl,method:"POST",data:{action:"et_ajax_template",template:"popup-section-options",id:d.attr("data-id"),style:btoa(d.attr("data-style")?d.attr("data-style"):""),multiple:e},dataType:"html",success:function(b){var e=etThemeBuilder.etGlobal.et_generate_random(7);c.parents(".et_customizer-builder").find(".et_header-head").append(b),a(".et_popup .style-popup-title").html(d.attr("data-title")),a(".et_popup").addClass(e+" for-"+d.attr("data-id")),a(".et_popup").draggable(),etThemeBuilder.etSections.et_close_style_column(),etThemeBuilder.etSections.et_save_style_column(d,e),etThemeBuilder.etSections.et_init_style_column(e)},error:function(a){etThemeBuilder.etGlobal.et_notice("block-style-popup","error")},complete:function(){}})})},et_close_style_column:function(){a(document).on("click",".et_close, .customize-panel-back",function(){a(".et_popup").remove()})},et_save_style_column:function(b,c){a(document).on("click","."+c+".et_popup.for-"+b.attr("data-id")+" .et_column-style-save",function(){var c={};a.each(a(".section-option"),function(b,d){c[a(d).attr("data-option")]=a(d).val()}),b.attr("data-style",JSON.stringify(c)),etThemeBuilder.etSections.et_set_column(b),a(".et_popup").remove()})},et_init_style_column:function(b){var c=a("."+b+'.et_popup [data-option="background-color"]');c.wpColorPicker();var c=a("."+b+'.et_popup [data-option="border-color"]');c.wpColorPicker();var c=a("."+b+'.et_popup [data-option="color"]');c.wpColorPicker(),etThemeBuilder.etGlobal.et_range_fields("."+b+" .section-border-radius .block-width"),a(document).on("click","."+b+" .etheme_upload-image, ."+b+" .et-background-image-upload",function(b){b.preventDefault();var c=a(this),d=wp.media.frames.file_frame=wp.media({title:"Select or upload image",library:{type:"image"},button:{text:"Select"},multiple:!1});d.on("select",function(){var a=d.state().get("selection").first().toJSON(),b=c.parents(".section-background-image");b.find(".placeholder.etheme_upload-image").addClass("hidden"),b.find(".attachment-thumb").attr("src",a.url),b.find(".attachment-thumb").removeClass("hidden"),b.find("input.background-image").attr("value",a.id),b.find("input.background-image").change(),b.find(".et-background-image-remove").removeClass("hidden")}),d.open()}),a(document).on("click",".et-background-image-remove",function(b){var c=a(this),d=c.parents(".section-background-image");c.addClass("hidden"),d.find("input.background-image").attr("value",""),d.find(".attachment-thumb").removeClass("hidden"),d.find(".attachment-thumb").addClass("hidden"),d.find(".placeholder.etheme_upload-image").removeClass("hidden"),d.find("input.background-image").change()})},et_remove_column:function(b){a(document).on("click",b+" .et_remove-column",function(b){etThemeBuilder.etSections.et_remove_all_inside(a(this).parents(".et_product-block")),a(this).parents(".et_product-block").remove(),etThemeBuilder.etSections.et_remove_data(a(this).parents(".et_product-block")),etThemeBuilder.etSections.et_disable_sticky(a(this).parents(".et_product-block"))})},et_set_options:function(b){a(document).on("change",b+' .et_product-block .block-width input[type="range"]',function(){etThemeBuilder.etSections.et_set_column(a(this).parents(".et_product-block"))}),a(document).on("input paste change",b+' .et_product-block .block-width input[type="text"]',function(){etThemeBuilder.etSections.et_set_column(a(this).parents(".et_product-block"))}),a(document).on("change",b+" .et_product-block .block-align input",function(){etThemeBuilder.etSections.et_set_column(a(this).parents(".et_product-block"))})},et_add_column:function(b,c){a(document).on("click",b+" .et_new-column",function(d){var e=a(this);e.css("pointer-events","none");var f=0;a.each(a(b+" .et_product-block:not(.et_new-column)"),function(){parseInt(a(this).attr("data-index"))>f&&(f=parseInt(a(this).attr("data-index")))}),a.ajax({url:ajaxurl,method:"POST",data:{action:"et_ajax_get_element",elements:"product-column",index:parseInt(f)+1,sticky:c.sticky},dataType:"html",success:function(c){a(b+" .et_product-single-inner").append(c),a.each(a(b+" .et_product-block:not(.et_new-column)"),function(){etThemeBuilder.etGlobal.et_range_fields('[data-id="'+a(this).attr("data-id")+'"] .block-width')}),a.each(a(b+" .et_product-block:not(.et_new-column"),function(){etThemeBuilder.etSections.et_set_column(a(this))}),etThemeBuilder.etSections.et_sortable(b)},error:function(a){etThemeBuilder.etGlobal.et_notice("add-column","error")},complete:function(){e.css("pointer-events","all")}})})},et_get_data:function(){var b=a(".et_customizer-builder.loaded").attr("data-option"),c=wp.customize.control(b).setting.get();return c=c?JSON.parse(c):""},et_set_data:function(b){if(b){var c=a(".et_customizer-builder.loaded").attr("data-option");wp.customize.control(c).setting.set(JSON.stringify(b))}},et_set_column:function(b){var c=this.et_get_data(),d=".et_customizer-builder.loaded",e=a(d+" .et_product-single .et_product-block").index(b);if(c){var f=[],g={};a.each(a(d+" .et_product-block:not(.et_new-column"),function(){f.push(a(this).attr("data-id"))}),a.each(c,function(a,b){-1==f.indexOf(a)&&delete c[a]}),c[b.attr("data-id")]&&c[b.attr("data-id")].data&&(g=c[b.attr("data-id")].data),b.attr("data-id")&&(c[b.attr("data-id")]={title:b.attr("data-title"),width:b.find('input[type="range"]').val(),index:e+1,align:b.find(".block-align input:checked").val(),sticky:b.attr("data-sticky"),data:g,style:b.attr("data-style")})}else c={},c[b.attr("data-id")]={title:b.attr("data-title"),width:b.find('input[type="range"]').val(),index:e+1,align:"start",sticky:b.attr("data-sticky"),data:{},style:{}};etThemeBuilder.etSections.et_set_data(c)},et_remove_data:function(a){var b=this.et_get_data();delete b[a.attr("data-id")],etThemeBuilder.etSections.et_set_data(b)},et_disable_sticky:function(b){var c=a(".et_customizer-builder.loaded").find('.et_column[data-sticky="'+b.attr("data-id")+'"]'),d=c.attr("data-id");if(c&&d){var e=this.et_get_data();e[d].sticky=!1,c.attr("data-sticky",!1),etThemeBuilder.etSections.et_set_data(e)}},et_add_inside:function(a,b){var c=this.et_get_data();c[a.attr("data-id")].data[b.attr("data-id")]={element:b.attr("data-element"),index:a.find(".et_column-content .et_customizer-element").index(b)},etThemeBuilder.etSections.et_set_data(c)},et_remove_inside:function(b){a(document).on("click",b+" .et_actions .et_remove",function(c){var d=a(this).parents(".et_customizer-element"),e=etThemeBuilder.etSections.et_get_data(),f=a(this).parents(".et_product-block").attr("data-id");d.parent().hasClass("et_inside-elements")?(etThemeBuilder.etConnectBlock.et_remove_inside(d),a(this).closest(".et_customizer-element").remove()):(delete e[f].data[d.attr("data-id")],etThemeBuilder.etSections.et_set_data(e)),"connect_block"==d.attr("data-element")?(etThemeBuilder.etConnectBlock.et_remove_all_inside(d.attr("data-id")),etThemeBuilder.etConnectBlock.et_remove_block(d.attr("data-id"))):a(b+" .et_column-inner").append('<div class="et_customizer-element ui-state-default ui-sortable-handle" data-id="'+d.attr("data-id")+'" data-size="1" data-element="'+d.attr("data-element")+'">'+d.html()+"</div>"),d.remove()})},et_remove_all_inside:function(b){var c=b,d=etThemeBuilder.etSections.et_get_data(),e=c.attr("data-id"),f={};a.each(d[e].data,function(a,b){"connect_block"!=b.element?f[b.element]="":(etThemeBuilder.etConnectBlock.et_remove_all_inside(a),etThemeBuilder.etConnectBlock.et_remove_block(a))}),a.ajax({url:ajaxurl,method:"POST",data:{action:"et_ajax_get_element",elements:f},dataType:"html",success:function(b){a(".et_customizer-builder.loaded .et_column-inner").append(b)},error:function(a){etThemeBuilder.etGlobal.et_notice("remove-inside-column","error")},complete:function(){}})}},etConnectBlock:{et_add_block:function(a){var b=this.et_get_package();b[b.length]={id:a,type:"horizontal",separator:"false",align:"center",spacing:"5",data:""},this.et_set_package(b)},et_get_inside:function(a,b){b||(b=a.parents(".et_popup").attr("data-id"));var c="",d={},e=this.et_get_package();return e.find(function(a,d,e){if(a.id==b)return c=d,!1}),e[c].data&&(d=JSON.parse(e[c].data)),{inside:d,blockID:c}},et_set_inside:function(a,b){var c=this.et_get_package();a=JSON.stringify(a),c[b].data=a,this.et_set_package(c)},et_set_type:function(a,b){var c="",d=this.et_get_package();d.find(function(b,d,e){if(b.id==a)return c=d,!1}),d[c].type=b,this.et_set_package(d)},et_get_type:function(a){var b="",c=this.et_get_package();return c.find(function(c,d,e){if(c.id==a)return b=d,!1}),c[b].type},et_set_separator:function(a,b){var c="",d=this.et_get_package();d.find(function(b,d,e){if(b.id==a)return c=d,!1}),d[c].separator=b,this.et_set_package(d)},et_get_separator:function(a){var b="",c=this.et_get_package();return c.find(function(c,d,e){if(c.id==a)return b=d,!1}),c[b].separator},et_set_align:function(a,b){var c="",d=this.et_get_package();d.find(function(b,d,e){if(b.id==a)return c=d,!1}),d[c].align=b,this.et_set_package(d)},et_get_align:function(a){var b="",c=this.et_get_package();return c.find(function(c,d,e){if(c.id==a)return b=d,!1}),c[b].align},et_add_inside:function(b){var c=this.et_get_inside(b),d=c.blockID,e=a(".et_inside-elements .et_customizer-element").index(b);c=c.inside,c[b.attr("data-element")]={index:e+1},this.et_set_inside(c,d)},et_remove_inside:function(a){var b=a.attr("data-element"),c=this.et_get_inside(a),d=c.blockID;c=c.inside,delete c[b],this.et_set_inside(c,d)},et_remove_all_inside:function(b){var c=this.et_get_inside("",b),d=this.et_get_block_package("selector");a.ajax({url:ajaxurl,method:"POST",data:{action:"et_ajax_get_element",elements:c.inside},dataType:"html",success:function(b){a(d).find(".et_column-inner").append(b),etThemeBuilder.etHeader.et_resizable()},error:function(a){etThemeBuilder.etGlobal.et_notice("remove-all-inside-block","error")},complete:function(){}})},et_remove_block:function(b){var c=this.et_get_package(),d="";a.each(c,function(a,c){c.id==b&&(d=a)}),c.splice(d,1),this.et_set_package(c)},et_convert_data:function(a,b){return b?(a=decodeURI(a),a=JSON.parse(a)):(a=JSON.stringify(a),a=encodeURI(a)),a},et_get_package:function(){var a=this.et_get_block_package("id"),b=wp.customize.control(a).setting.get();return b=this.et_convert_data(b,!0)},et_set_package:function(a){var b=this.et_get_block_package("id");a=this.et_convert_data(a,!1),wp.customize.control(b).setting.set(a)},et_get_block_package:function(b){var c="connect_block_package",d=".et_desktop-mod";return a(".et_customizer-builder-single_product").hasClass("loaded")?(c="connect_block_product_single_package",d=".et_customizer-builder-single_product"):a(".et_customizer-builder-archive_product").hasClass("loaded")?(c="connect_block_product_archive_package",d=".et_customizer-builder-archive_product"):a(".wp-full-overlay").hasClass("preview-mobile")&&(c="connect_block_mobile_package",d=".et_mobile-mod"),"id"==b?c:d},et_get_spacing:function(a,b){var c="",d=this.et_get_package();return d.find(function(b,d,e){if(b.id==a)return c=d,!1}),d[c].spacing},et_set_spacing:function(a,b){var c="",d=this.et_get_package();d.find(function(b,d,e){if(b.id==a)return c=d,!1}),d[c].spacing=b,this.et_set_package(d)},et_popup:function(b){var c=b.parents('[data-element="connect_block"]'),d=c.attr("data-id"),e=this.et_get_inside("",d),f=this.et_get_type(d),g=this.et_get_separator(d),h=this.et_get_align(d),i=this.et_get_spacing(d);c.addClass("et_popup-open"),a(".et_popup").remove(),a.ajax({url:ajaxurl,method:"POST",data:{action:"et_ajax_popup",elements:e.inside,type:f,separator:g,align:h,spacing:i,id:d},dataType:"html",success:function(b){c.parents(".et_customizer-builder").find(".et_header-head").append(b),etThemeBuilder.etGlobal.et_range_fields("#et_popup-slider"),a(".et_popup").draggable(),a(".et_inside-elements").sortable({stop:function(b,c){var d=c.item;a.each(d.parents(".et_popup").find(".et_customizer-element"),function(){etThemeBuilder.etConnectBlock.et_add_inside(a(this))})}}).disableSelection()},error:function(a){etThemeBuilder.etGlobal.et_notice("block-popup","error")},complete:function(){}}),a(document).on("change","#block_type",function(){var b="horizontal";a(this).is(":checked")&&(b="vertical");var c=a(this).parents(".et_popup").attr("data-id");etThemeBuilder.etConnectBlock.et_set_type(c,b)}),a(document).on("change","#block_separator",function(){var b="false";a(this).is(":checked")&&(b="true");var c=a(this).parents(".et_popup").attr("data-id");etThemeBuilder.etConnectBlock.et_set_separator(c,b)}),a(document).on("change","#input_block_align input",function(){var b=a(this).parent().find("input:checked").val(),c=a(this).parents(".et_popup").attr("data-id");etThemeBuilder.etConnectBlock.et_set_align(c,b)}),a(document).on("mousemove change",'#et_popup-slider input[type="range"]',function(){var b=a(this).val(),c=a(this).parents(".et_popup").attr("data-id");etThemeBuilder.etConnectBlock.et_set_spacing(c,b)}),a(document).on("input paste change",'#et_popup-slider input[type="text"]',function(){var b=a(this).val(),c=a(this).parents(".et_popup").attr("data-id");etThemeBuilder.etConnectBlock.et_set_spacing(c,b)}),a(document).on("click",".et_close, .et_button.mobile, .et_button.desktop, .customize-panel-back",function(){c.removeClass("et_popup-open"),a(".et_popup").remove()})}},etHeader:{et_init:function(){this.et_remove(),this.et_change_device(),this.et_force_resize(),this.et_sortable(),this.et_resizable(),this.et_external_resize(),etThemeBuilder.etGlobal.et_panel_resize(".et_customizer-builder-header")},et_show:function(){a(".et_customizer-builder.et_customizer-builder-header").removeClass("hidden fadeOut").addClass("slide-top"),setTimeout(function(){a(".et_customizer-builder.et_customizer-builder-header").addClass("loaded")},300)},et_close:function(){a(".et_customizer-builder.et_customizer-builder-header").removeClass("slide-top").addClass("fadeOut"),setTimeout(function(){a(".et_customizer-builder.et_customizer-builder-header").removeClass("loaded collapsed").addClass("hidden")},200)},et_sortable:function(){a(".et_customizer-builder-header .et_column:not(.et_col-sm-12), .et_customizer-builder-header .et_elements .et_column-inner").sortable({connectWith:".et_column",cursorAt:{left:5,top:5},cancel:".et_popup-open",helper:function(a,b){return this.connectBlock=!1,b.parents(".et_header-part").hasClass("et_elements")&&"connect_block"==b.attr("data-element")?(this.connectBlock="element-"+etThemeBuilder.etGlobal.et_generate_random(5),b.clone().insertAfter(b),b.attr("data-id",this.connectBlock),'<span class="et_sorting-gost dashicons dashicons-image-rotate-left"></span>'):'<span class="et_sorting-gost dashicons dashicons-image-rotate-left"></span>'},start:function(b,c){var d=c.item,e=d.parent();this.startParent=e,this.removeData=!1,this.removeSection=d.parents(".et_header-part").attr("data-section"),a("body").removeClass("et_stop-drop"),e.removeClass("et_has-element")},over:function(b,c){a(this).addClass("et_sorting-over")},out:function(b,c){a(this).removeClass("et_sorting-over")},stop:function(b,c){var d=c.item,e=d.parent(),f=d.outerWidth(),g=d.outerWidth(!0);if(a(".et_sorting-over").removeClass("et_sorting-over"),d.parent().hasClass("et_inside-elements")){if(d.addClass("et_in-popup"),"connect_block"==d.attr("data-element")&&e.hasClass("et_inside-elements"))return this.startParent.hasClass("et_column-inner")?void d.remove():(a(this).sortable("cancel"),void this.startParent.addClass("et_has-element"));etThemeBuilder.etHeader.et_delete_data(d,this.removeSection),a.each(d.parents(".et_popup").find(".et_customizer-element"),function(){etThemeBuilder.etConnectBlock.et_add_inside(a(this))})}else{if("connect_block"==d.attr("data-element")&&"et_column-inner"==e.attr("class"))return void d.remove();if(d.parents(".et_header-part").hasClass("et_elements"))return void("connect_block"==d.attr("data-element")&&d.remove());var h="connect_block"==d.attr("data-element")&&this.startParent.hasClass("et_column-inner");if(e.hasClass("et_has-element"))return h?void d.remove():(a(this).sortable("cancel"),void this.startParent.addClass("et_has-element"));if(etThemeBuilder.etHeader.et_stop_drop(e,"","",a(this),h,d),a("body").hasClass("et_stop-drop"))return void this.startParent.addClass("et_has-element");if(e.addClass("et_has-element"),etThemeBuilder.etHeader.et_delete_data(d,this.removeSection),d.outerWidth()<d.parent().width()&&d.outerWidth(d.parent().width()-(g-f)),12==e.attr("data-index")&&d.attr("data-size")>1&&(d.outerWidth(d.parent().width()-(g-f)),d.attr("data-size",1)),!d.parents(".et_header-part").find('[data-index="12"]').hasClass("et_has-element")){var i=0;if(a.each(d.parents(".et_header-part").find(".et_column"),function(){a(this).hasClass("et_has-element")&&(i=a(this).attr("data-index"))}),parseInt(e.attr("data-index"))>=i&&parseInt(d.attr("data-size"))+parseInt(e.attr("data-index"))-1>12){var j=12-parseInt(e.attr("data-index"))+1;d.attr("data-size",j),d.outerWidth(d.parent().width()*j-(g-f))}}a.each(d.parents(".et_header-part").find(".et_customizer-element:not(.et_in-popup)"),function(){var b=parseInt(a(this).parent().attr("data-index")),c=parseInt(e.attr("data-index"));if(b>c&&parseInt(d.attr("data-size"))+c>b){var f=d.outerWidth(),g=d.outerWidth(!0),h=b-c;d.attr("data-size",h),d.outerWidth(e.width()*h-(g-f)),etThemeBuilder.etHeader.et_set_data(d,d.parent())}etThemeBuilder.etHeader.et_set_data(a(this),a(this).parent())}),a.each(this.startParent.parents(".et_header-part").find(".et_customizer-element:not(.et_in-popup)"),function(){etThemeBuilder.etHeader.et_set_data(a(this),a(this).parent())}),this.connectBlock&&(etThemeBuilder.etConnectBlock.et_add_block(this.connectBlock),etThemeBuilder.etHeader.et_resizable(d),d.removeClass("et-stuck-block"))}}}).disableSelection()},et_resizable:function(b){b||(b=a(".et_customizer-builder-header .et_customizer-element:not(.et-stuck-block)")),b.resizable({handles:"e",grid:a(".et_device:not(.hidden) .et_sortable").width(),maxWidth:12*a(".et_device:not(.hidden) .et_sortable").width(),cancel:".et_popup-open",start:function(b,c){var d=c.element,e=d.parent(),f=!1,g=a(this);a.each(d.parents(".et_header-part").find(".et_customizer-element:not(.et_in-popup)"),function(){var b=parseInt(a(this).parent().attr("data-index")),c=parseInt(e.attr("data-index"));if(b>c)return g.resizable("option","maxWidth",(b-c)*e.width()),f=!0,!1}),this.width=c.element.width(),f||a(this).resizable("option","maxWidth",12*e.width())},resize:function(b,c){this.width=c.element.width();var d=Math.ceil(this.width/a(".et_device:not(.hidden) .et_sortable").width());c.element.attr("data-size",d)},stop:function(b,c){var d=c.element,e=d.parent(),f=d.attr("data-size"),g=d.outerWidth(),h=d.outerWidth(!0);f=Math.ceil(this.width/a(".et_device:not(.hidden) .et_sortable").width()),d.attr("data-size",f),d.outerWidth(e.width()*f-(h-g)),a(this).resizable("option","maxWidth",12*e.width()),a.each(d.parents(".et_header-part").find(".et_customizer-element:not(.et_in-popup)"),function(){etThemeBuilder.etHeader.et_set_data(a(this),a(this).parent())})}}).disableSelection()},et_force_resize:function(){a.each(a(".et_sortable .et_customizer-element"),function(){var b=a(this).parent(),c=a(this).attr("data-size"),d=a(this).outerWidth(),e=a(this).outerWidth(!0);a(this).outerWidth(b.width()*c-(e-d))})},et_external_resize:function(){a(document).on("click","button.collapse-sidebar",function(){setTimeout(function(){etThemeBuilder.etHeader.et_force_resize(),etThemeBuilder.etHeader.et_resizable()},200)})},et_remove:function(){a(document).on("click",".et_customizer-builder-header .et_remove",function(){var b=a(this).parents(".et_customizer-element");if(b.parent().removeClass("et_has-element"),"connect_block"==b.attr("data-element"))return etThemeBuilder.etConnectBlock.et_remove_all_inside(b.attr("data-id")),etThemeBuilder.etConnectBlock.et_remove_block(b.attr("data-id")),a.each(a(this).parents(".et_header-part").find(".et_customizer-element:not(.et_in-popup)"),function(){etThemeBuilder.etHeader.et_set_data(a(this),a(this).parent())}),etThemeBuilder.etHeader.et_delete_data(b),b.remove(),void etThemeBuilder.etHeader.et_resizable();b.parent().hasClass("et_inside-elements")?(etThemeBuilder.etConnectBlock.et_remove_inside(b),
a(this).closest(".et_customizer-element").remove()):(a.each(a(this).parents(".et_header-part").find(".et_customizer-element:not(.et_in-popup)"),function(){etThemeBuilder.etHeader.et_set_data(a(this),a(this).parent())}),etThemeBuilder.etHeader.et_delete_data(b),b.remove());var c=a(".et_desktop-mod");a(".wp-full-overlay").hasClass("preview-mobile")&&(c=a(".et_mobile-mod")),c.find(".et_elements .et_column .et_column-inner").append('<div class="et_customizer-element ui-state-default ui-sortable-handle" data-id="'+b.attr("data-id")+'" data-size="1" data-element="'+b.attr("data-element")+'">'+b.html()+"</div>"),etThemeBuilder.etHeader.et_resizable()})},et_delete_data:function(a,b){if(b||(b=a.parents(".et_header-part").attr("data-section")),b){var c=wp.customize.control(b).setting.get();c=c?JSON.parse(c):{},delete c[a.attr("data-id")],wp.customize.control(b).setting.set(JSON.stringify(c))}},et_stop_drop:function(b,c,d,e,f,g){var h=b.prev();d||(d=b),c||(c=1),++c>=12||(h.hasClass("et_has-element")?parseInt(h.attr("data-index"))+parseInt(h.find(".et_customizer-element").attr("data-size"))>parseInt(d.attr("data-index"))&&(f?g.remove():e.sortable("cancel"),a("body").addClass("et_stop-drop")):etThemeBuilder.etHeader.et_stop_drop(h,c,d,e,f,g))},et_change_device:function(){a(document).on("click",".devices-wrapper button",function(){a(this).hasClass("preview-desktop")?(a(".et_customizer-builder-header .et_desktop-mod").removeClass("hidden"),a(".et_customizer-builder-header .et_mobile-mod").addClass("hidden")):(a(".et_customizer-builder-header .et_desktop-mod").addClass("hidden"),a(".et_customizer-builder-header .et_mobile-mod").removeClass("hidden")),a(".et_headers-multiple").addClass("hidden"),etThemeBuilder.etHeader.et_force_resize(),wp.customize.previewer.refresh()}),a(document).on("click",".et_button.desktop, .et_button.mobile",function(b){var c=a(this).data("device");a(".devices-wrapper .preview-"+c).trigger("click"),a(".et_button.desktop, .et_button.mobile").removeClass("inactive"),a(this).hasClass("desktop")?(a(".et_customizer-builder-header .et_desktop-mod").removeClass("hidden"),a(".et_customizer-builder-header .et_mobile-mod").addClass("hidden")):(a(".et_customizer-builder-header .et_desktop-mod").addClass("hidden"),a(".et_customizer-builder-header .et_mobile-mod").removeClass("hidden")),a(".et_headers-multiple").addClass("hidden"),a(".et_call-multiple-headers").removeClass("active"),etThemeBuilder.etHeader.et_force_resize(),wp.customize.previewer.refresh()}),a(document).on("click",".customize-control .devices button",function(b){var c=a(this).data("device");a(".devices-wrapper .preview-"+c).trigger("click"),wp.customize.previewer.refresh()})},et_set_data:function(b,c){if(b&&c){var d=b.parents(".et_header-part").attr("data-section");if(d){var e=wp.customize.control(d).setting.get();if(etThemeBuilder.etHeader.et_set_offset(c),e){e=JSON.parse(e);var f=[];a.each(a("[data-section="+d+"] .et_customizer-element"),function(){f.push(a(this).attr("data-id"))}),a.each(e,function(a,b){-1==f.indexOf(a)&&delete e[a]}),b.attr("data-id")&&(e[b.attr("data-id")]={size:b.attr("data-size"),index:c.attr("data-index"),offset:b.attr("data-offset"),element:b.attr("data-element")})}else e={},e[b.attr("data-id")]={size:b.attr("data-size"),index:c.attr("data-index"),offset:b.attr("data-offset"),element:b.attr("data-element")};wp.customize.control(d).setting.set(JSON.stringify(e))}}},et_set_offset:function(a,b,c){var d=a.prev(),e={};if(c||(c=a),e.current={size:c.find(".et_customizer-element").attr("data-size"),index:c.attr("data-index")},1==e.current.index)return void c.find(".et_customizer-element").attr("data-offset",0);if(b||(b=1),!(++b>=13))if(d.hasClass("et_has-element")){e.prev={size:d.find(".et_customizer-element").attr("data-size"),index:d.attr("data-index")};var f=parseInt(e.current.index)-(parseInt(e.prev.index)+parseInt(e.prev.size));c.find(".et_customizer-element").attr("data-offset",f)}else 1!=d.attr("data-index")||d.hasClass("et_has-element")?etThemeBuilder.etHeader.et_set_offset(d,b,c):c.find(".et_customizer-element").attr("data-offset",e.current.index-1)}}},a(document).ready(function(){etThemeBuilder.init()})}(jQuery);