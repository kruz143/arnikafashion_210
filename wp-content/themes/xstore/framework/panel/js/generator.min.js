var generator_required=[];window.et_panel=window.et_panel||{},function(e){e(document).ready(function(e){var t={generator_section_child_change:function(e){e.prop("checked")?e.parents(".opt-section").find("input:not(.input-section)").prop("checked",!0):e.parents(".opt-section").find("input:not(.input-section)").prop("checked",!1)},generator_subsection_child_change:function(e){e.prop("checked")?e.parents(".opt-subsection").find("input:not(.has-subsection)").prop("checked",!0):e.parents(".opt-subsection").find("input:not(.has-subsection)").prop("checked",!1)},generator_parent_change:function(e){e.prop("checked")&&(e.closest(".has-subsection").find(".opt-item").first().find("input").prop("checked",!0),e.closest(".opt-section.has-subsection").find(".opt-item").first().find("input").prop("checked",!0))},generator_remove_file:function(t){confirm("Are you sure? ")&&e.ajax({method:"POST",url:ajaxurl,dataType:"JSON",data:{action:"et_panel_ajax",type:"css",action_type:"et_generator_remover"},success:function(t){"success"==t.status?(e(".css_generator-info").html(""),e(".css_generator-info").html(t.response.html).addClass("no-file-generated")):alert(t.response.msg)},error:function(){alert("ajax error")}})},generator_calc:function(e){et_panel.generator_calc_system_files(e),et_panel.generator_set_counter()},generator_generate_file:function(t,a){a.preventDefault();var s=t.serializeArray(),r="",n=[],o=e(".et_panel-popup");e.each(s,function(t,a){if(a.value.includes(",")){var s=a.value.split(",");e.each(s,function(e,t){n.includes(t)||(n.push(t),r+=t+",")})}else r+=a.value+","}),r=r.slice(0,-1),o.html('<div class="et-loader ">\t\t\t\t\t<svg class="loader-circular" viewBox="25 25 50 50">\t\t\t\t\t<circle class="loader-path" cx="50" cy="50" r="12" fill="none" stroke-width="2" stroke-miterlimit="10"></circle>\t\t\t\t\t</svg>\t\t\t\t</div>'),e("body").addClass("et_panel-popup-on"),e.ajax({method:"POST",url:ajaxurl,dataType:"JSON",data:{action:"et_panel_ajax",modules:r,type:t.attr("type"),action_type:"et_generator"},success:function(t){o.html(""),o.addClass("loading"),o.prepend('<span class="et_close-popup et-button-cancel et-button"><i class="et-admin-icon et-delete"></i></span>'),o.addClass("panel-popup-import").append(t.response.icon),o.append(t.response.msg),o.append(t.response.btn),o.addClass("active").removeClass("loading"),"success"==t.status&&(e(".css_generator-info").html(""),e(".css_generator-info").html("<h2>Latest generated file:</h2><p><strong>File location: </strong>"+t.response.data.path+"</p><p><strong>File size: </strong>"+t.response.data.size+'</p><span class="et-css-remove et-generated-remove"><span class="dashicons dashicons-trash"></span>Remove</span>').removeClass("no-file-generated"))},error:function(){alert("ajax error")}})},generator_set_counter:function(t){var a=0,s=0,r=e(".etheme-generator-head .counter-size"),n=e(".etheme-generator-head .counter-value"),o=e(".etheme-generator-head .counter-value-percent"),i=parseInt(r.data("max_size")),c=parseInt(r.data("stroke-dasharray-start")),l=parseInt(r.data("stroke-dasharray-end")),p=e(".etheme-generator-footer button");e(".etheme-css-generator .et_generator-form input:not(.has-subsection):checked").each(function(t,r){s++,e(r).attr("data-size")&&(a=parseFloat(parseFloat(a)+parseFloat(e(r).attr("data-size"))).toFixed(1))}),s>1?p.removeClass("et-button-dark-grey").addClass("et-button-green").removeAttr("disabled"):p.removeClass("et-button-green").addClass("et-button-dark-grey").attr("disabled",1),n.text("~"+a+"Kb");var d=a/i*100;d="~"+d.toFixed(1)+"%",o.text(d),e(r).css("strokeDasharray",a/i*c+"px "+l+"px"),e(".etheme-page-content").addClass("primary-counted")},generator_calc_system_files:function(t){var a=e(".opt-section.required"),s=a.find(".size-value"),r=s.attr("data-size"),n=a.find(".input-section");if(t&&!t.prop("checked")){if(t.attr("data-required")){var o=JSON.parse(t.attr("data-required"));e.each(o,function(e,t){generator_required.includes(e)&&(generator_required.splice(e,1),r=parseFloat(parseFloat(r)-parseFloat(t)).toFixed(1),s.html(r),s.attr("data-size",r),n.find("input").attr("data-size",r))})}et_panel.generator_calc_section(t,!1)}else t&&et_panel.generator_calc_section(t,!0);e(".etheme-css-generator .et_generator-form input:checked").each(function(t,n){if(e(".etheme-page-content").hasClass("primary-counted")||et_panel.generator_calc_section(e(n),!0),e(n).attr("data-required")){var o=JSON.parse(e(n).attr("data-required"));e.each(o,function(e,t){generator_required.includes(e)||(generator_required.push(e),r=parseFloat(parseFloat(r)+parseFloat(t)).toFixed(1),s.html(r),s.attr("data-size",r),a.find("input").attr("data-size",r))})}})},generator_calc_section:function(t,a){if(!t.parents(".opt-section").hasClass("required")){var s=t.closest(".opt-section"),r=s.find(".real-size").first().attr("data-size"),n=t.closest(".opt-subsection.has-subsection"),o=n.find(".real-size").attr("data-size"),i=0,c=0;if(t.hasClass("has-subsection")&&e(".etheme-page-content").hasClass("primary-counted"))if(a){l=s.find(".opt-subsection.has-subsection input.has-subsection").parent();e.each(l,function(){var t=e(this).find(".real-size"),a=e(this).find(".size-value").attr("data-size");t.html(a).attr("data-size",a)}),i=t.attr("data-size"),t.closest(".opt-item").find(".real-size").html(i).attr("data-size",i),c=parseFloat(parseFloat(r)+parseFloat(t.attr("data-size"))).toFixed(1)}else{i=0;var l=s.find(".opt-subsection.has-subsection input.has-subsection").parent();e.each(l,function(){e(this).find(".real-size").html(0).attr("data-size",0)}),c=parseFloat(parseFloat(r)-parseFloat(t.attr("data-size"))).toFixed(1),t.closest(".opt-item").find(".real-size").html(i).attr("data-size",i)}else{if(t.hasClass("has-subsection"))return;a?(i=parseFloat(parseFloat(o)+parseFloat(t.attr("data-size"))).toFixed(1),c=parseFloat(parseFloat(r)+parseFloat(t.attr("data-size"))).toFixed(1)):(i=parseFloat(parseFloat(o)-parseFloat(t.attr("data-size"))).toFixed(1),c=parseFloat(parseFloat(r)-parseFloat(t.attr("data-size"))).toFixed(1))}(i<0||isNaN(i))&&(i=0),(c<0||isNaN(c))&&(c=0),n.find(".real-size").html(i).attr("data-size",i),s.find(".real-size").first().html(c).attr("data-size",c)}}};window.et_panel=Object.assign(window.et_panel,t);var a={1:{selector:".opt-section.has-subsection input.input-section.has-subsection",type:"change",callback:et_panel.generator_section_child_change},2:{selector:".opt-subsection.has-subsection input.has-subsection",type:"change",callback:et_panel.generator_subsection_child_change},3:{selector:".opt-item input",type:"change",callback:et_panel.generator_parent_change},4:{selector:".et-css-remove",type:"click",callback:et_panel.generator_remove_file},5:{selector:".etheme-css-generator .et_generator-form input",type:"change",callback:et_panel.generator_calc},6:{selector:".etheme-css-generator .et_generator-form input",type:"ready",callback:et_panel.generator_calc},7:{selector:"form.et_generator-form",type:"submit",callback:et_panel.generator_generate_file}};e.each(a,function(t,a){"ready"==a.type?e(document).ready(function(t){a.callback(e(this),t)}):e(document).on(a.type,a.selector,function(t){a.callback(e(this),t)})})})}(jQuery,window.et_panel);